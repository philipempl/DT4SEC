<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">IoT-Based Digital Twin for Energy Cyber-Physical Systems: Design and Implementation</title>
			</titleStmt>
			<publicationStmt>
				<publisher>MDPI AG</publisher>
				<availability status="unknown"><p>Copyright MDPI AG</p>
				</availability>
				<date type="published" when="2020-09-12">12 September 2020</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Ahmed</forename><surname>Saad</surname></persName>
							<idno type="ORCID">0000-0001-9726-7411</idno>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical and Computer Engineering</orgName>
								<orgName type="institution">Florida International University</orgName>
								<address>
									<postCode>33174</postCode>
									<settlement>Miami</settlement>
									<region>FL</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Samy</forename><surname>Faddel</surname></persName>
							<email>samy.faddel@ucf.edu</email>
							<idno type="ORCID">0000-0001-9726-7411</idno>
							<affiliation key="aff1">
								<orgName type="department">Department of Electrical and Computer Engineering</orgName>
								<orgName type="institution">University of Central Florida</orgName>
								<address>
									<postCode>32816</postCode>
									<settlement>Orlando</settlement>
									<region>FL</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Osama</forename><surname>Mohammed</surname></persName>
							<email>mohammed@fiu.edu</email>
							<idno type="ORCID">0000-0002-2586-4046</idno>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical and Computer Engineering</orgName>
								<orgName type="institution">Florida International University</orgName>
								<address>
									<postCode>33174</postCode>
									<settlement>Miami</settlement>
									<region>FL</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">IoT-Based Digital Twin for Energy Cyber-Physical Systems: Design and Implementation</title>
					</analytic>
					<monogr>
						<title level="j" type="main">Energies</title>
						<title level="j" type="abbrev">Energies</title>
						<idno type="eISSN">1996-1073</idno>
						<imprint>
							<publisher>MDPI AG</publisher>
							<biblScope unit="volume">13</biblScope>
							<biblScope unit="issue">18</biblScope>
							<biblScope unit="page">4762</biblScope>
							<date type="published" when="2020-09-12">12 September 2020</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.3390/en13184762</idno>
					<note type="submission">Received: 1 August 2020; Accepted: 9 September 2020;</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.2" ident="GROBID" when="2021-06-09T12:54+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>distributed resources</term>
					<term>cyber-physical systems</term>
					<term>digital twin</term>
					<term>industrial internet of things</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>With the emergence of distributed energy resources (DERs), with their associated communication and control complexities, there is a need for an efficient platform that can digest all the incoming data and ensure the reliable operation of the power system. The digital twin (DT) is a new concept that can unleash tremendous opportunities and can be used at the different control and security levels of power systems. This paper provides a methodology for the modelling of the implementation of energy cyber-physical systems (ECPSs) that can be used for multiple applications. Two DT types are introduced to cover the high-bandwidth and the low-bandwidth applications that need centric oversight decision making. The concept of the digital twin is validated and tested using Amazon Web Services (AWS) as a cloud host that can incorporate physical and data models as well as being able to receive live measurements from the different actual power and control entities. The experimental results demonstrate the feasibility of the real-time implementation of the DT for the ECPS based on internet of things (IoT) and cloud computing technologies. The normalized mean-square error for the low-bandwidth DT case was 3.7%. In the case of a high-bandwidth DT, the proposed method showed superior performance in reconstructing the voltage estimates, with 98.2% accuracy from only the controllers' states.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Future power distribution systems consist of multiple entities that interact with each other in real time. The increased adoption of distributed energy resources (DERs) and active prosumers in the power network will result in more data sharing and processing. A microgrid represents the basic building block of future power systems, where a microgrid's agent/operator should ensure load-generation balance in its territory while interacting with other microgrids' agents or the distribution system operator <ref type="bibr" target="#b0">[1]</ref>. From a holistic perspective, the future active distribution system can be viewed as a network of interconnected microgrids. The emergence of these interconnected microgrids can increase the efficiency of the system and ensure the reliable operation of the power grid during normal and extreme conditions. However, with such interconnected networks, there will be much more complexity, data communication and processing.</p><p>To mitigate these kinds of issues and to harness the usage of the insights available from the collected data, Industry 4.0 has emerged as the next industrial revolution, with internet of things (IoT) and cloud computing as cornerstones of its deployment <ref type="bibr" target="#b1">[2]</ref>. In that domain, many researchers have started to investigate the potential of IoT in different applications. Among these different applications is the energy-cyber-physical system. The deployment of IoT in that domain can be used to converge the current power system into the synergetic cyber-physical system that is the smart grid <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b3">4]</ref>. In <ref type="bibr" target="#b4">[5]</ref>, an IoT high-level framework for the design of information and communication technologies systems for smart microgrids was proposed. The authors described the different applications that can be realized when the power system becomes a part of an IoT framework and the potential information flow associated with different applications.</p><p>Turning the current power grid into an IoT technology-dependent one means that a large number of data are harvested from the physical assets' sensors and the cyber assets' controllers. This will greatly affect our current understanding of the energy sector <ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b8">[9]</ref><ref type="bibr" target="#b9">[10]</ref><ref type="bibr" target="#b10">[11]</ref><ref type="bibr" target="#b11">[12]</ref>. An example of the sensors and data shared in a microgrid can be found in <ref type="bibr" target="#b12">[13]</ref>, where energy management as a cloud service was explored to provide a control platform for a residential microgrid. With the incoming stream of data and operational real-time requirements as well as the potential cyber-attacks on the communication network, there is a need for a conceptual framework that can monitor, collect, harness and interact with the physical components to ensure their optimal operation. The digital twin (DT) concept arises as a promising solution that can provide such a framework and unleash many opportunities and gains that are associated with the flow of data and real-time interaction. The digital twin concept was first introduced publicly by NASA in 2010 <ref type="bibr" target="#b13">[14]</ref>.</p><p>A digital twin can be defined as a digital replica/model that includes the last information matching a thing. The information provided by a DT can provide numerous optimization possibilities for a cyber-physical system. The DT was successfully applied recently in industry for the manufacturing, power plants, healthcare and automotive sectors <ref type="bibr" target="#b14">[15,</ref><ref type="bibr" target="#b15">16]</ref>. In addition, several industrial enterprises are devoting efforts to developing digital replications of power grids, such as General Electric (GE, Boston, MA, USA) or Siemens (Munich, Germany) <ref type="bibr" target="#b16">[17,</ref><ref type="bibr" target="#b17">18]</ref>.</p><p>Many studies in the literature have started developing and describing conceptual designs and applications of digital twins. A description of the expected main building blocks for a general cyber-physical system was introduced in <ref type="bibr" target="#b18">[19]</ref>. In <ref type="bibr" target="#b19">[20]</ref>, the authors presented a digital twin architecture for the security of an industrial automation system, where they proposed a security-oriented digital twin for the Programable Logic Control (PLC) software update process. In <ref type="bibr" target="#b20">[21]</ref>, the author provided a cloud-based digital twin for a cyber-physical system with an application to the social internet of vehicles for driving assistance application.</p><p>Few researchers have started to deploy and implement the digital twin for power system applications. To date, and to the best of our knowledge, there is not much literature that describes an actual design and implementation of a digital twin in the electric power-grid domain. In <ref type="bibr" target="#b21">[22]</ref>, the authors provided a general first-steps description of the implementation of a digital twin of a single microgrid. No details or implementation are provided. Therefore, this draft tries to cover this gap by providing a detailed explanation and implementation of a low-cost, open-source-based and close-to-market proof of concept for a digital-twin framework for power system applications. The proposed framework can be used in many applications of power systems, ranging from the simple monitoring of the system and actual control and interaction with the physical system to attack detection on the communication layer. Therefore, the main contributions of this paper are:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>1.</head><p>Describing a methodology for how digital twins of the different power resources in the power system can be modelled on the cloud.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>2.</head><p>Providing an IoT-based digital twin of an interconnected system of microgrids.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>3.</head><p>Developing an IoT-based digital twin model of the communication topology that can serve a cluster of microgrids. 4.</p><p>Providing a proof of concept case study where controllers/agents interact with each other and the cloud.</p><p>The rest of the paper is organized as follows: Section 2 provides a general description of the proposed architecture, while Section 3 explains the proposed digital twin models. Section 4 describes the cloud utilization, Section 5 provide case studies and Section 6 concludes the research work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Architecture Description</head><p>In modern power systems, the microgrid is a vital infrastructure that enables higher renewables penetration in the deep distribution grid. The microgrid contains different distributed generation resources (DERs), energy storage systems (ESSs) and flexible loading, which transform the distribution grid into a fleet of virtual power plants. At this level of the networked microgrids, a huge number of assets, sensors, meters, actuators and controllers will be connected to the Internet through heterogenous IoT communication networks. Figure <ref type="figure" target="#fig_0">1</ref> shows the proposed cloud-based digital twin architecture, which could be the strategic technology that coordinates, facilitates, aggregates and provides centric oversight guidance for the new distribution system infrastructure. The proposed digital twin is illustrated as a virtual replica for both the physical and cyber layers of the networked microgrids. The physical layer consists of many assets (things) such as DERs, ESSs, fixed loads, flexible loads, DC/DC converters, DC/AC inverters, cables, transmission lines, transformers and circuit breakers. The power electronic converters are considered as the main vital actuators that fully control the distribution grid. It can flexibly route the power flow in the power lines and guarantee proper power sharing among DERs and ESSs inside a microgrid or between the networked microgrids. The interconnected microgrids forms clusters that are connected to the power system point of common coupling (PCC) through an IC pcc and a step-up transformer.</p><p>The edge cyber system space contains networked sensors/intelligent electronic devices (IEDs) that communicate with each other through an internet protocol such as transmission control protocol/internet protocol (TCP/IP). The sensors monitor the physical assets by widespread current transformers, voltage transformers, temperature and weather transducers, micro-phasor-measurement units (µPMUs), fault locators and protective relays. In addition, the cyber system makes decisions using the networked controllers as a distributed secondary control system that is responsible for voltage regulation, frequency synchronization, and active and reactive power sharing control. On top of the secondary controllers is the tertiary control system, which is responsible for the energy management, market operations and the major global control/optimization object. The cyber control layer and its communication network take the power system automation control and protection decisions during the normal and abnormal conditions based on the feedback from the networked sensors. With this level of complex transactions among the cyber things and between the physical and cyber things, centric oversight is required to autonomously monitor, operate, analyze and understand the cyber-physical energy system. The virtual space is proposed as a centric oversight layer, which can deal with such complex systems using multiple coordinated cloud services.</p><p>The Amazon Web Services (AWS) cloud system is utilized to implement the proposed virtual space. The physical things are monitored by the sensors' measurements and hosted in AWS IoT GreenGrass (GG). Each microgrid's measurements are accommodated in the GG group. The AWS GG can act locally on the data and respond quickly to events and has a low cost, especially for a large number of data points. The AWS GG is proposed here because it helps to preserve privacy and maintains efficient computing inside each microgrid. Regarding the control system in the cyberspace, the controllers' states are hosted as cyber things in the AWS IoT core. The last states of both the cyber and physical things are kept as a shadow on the cloud.</p><p>For both the cyber and physical things, a serviceless computing function-which is a low cost, simplified microservice-is used to monitor the data activity and take/activate local actions or launch another computing service/application according to pre-defined logic settings. The IoT shadow states are considered as the shadow twin for the energy cyber-physical system (ECPS). The shadow twin contains the metadata and the last states for the physical and the cyber assets. This shadow can be used for different power system applications, even with intermittent measurement updates. Additionally, the cyber twin state-space model and the physical twin state-space model are used to enhance the digital replica of the ECPS.</p><p>Multiple services are deployed to manage, filter, analyze and store data for better utilization among the energy system applications and solutions. The proposed digital twins are cooperatively utilized to represent the actual ECPS, which could extend the virtual space capabilities for many different applications in the future. For instance, energy management, security auditing, distributed control guidance, power system state estimation, what-if scenarios, predictive maintenance for energy assets, outage management, wide area fault tolerance and power system restoration are promising applications that could enhance future distribution grid reliability and security. Additionally, the scalability feature of the IoT in the energy systems will provide an incentive for power system designers, operators and researchers to better understand the new distribution grid capabilities.</p><p>Energies 2020, 13, x FOR PEER REVIEW 4 of 19 guidance, power system state estimation, what-if scenarios, predictive maintenance for energy assets, outage management, wide area fault tolerance and power system restoration are promising applications that could enhance future distribution grid reliability and security. Additionally, the scalability feature of the IoT in the energy systems will provide an incentive for power system designers, operators and researchers to better understand the new distribution grid capabilities.   </p><note type="other">IED 41 IED 11 IED 31 IED 21 IED 12 IED 22 IED 13 IED 23 IED</note></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Sensors Outputs</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Digital Twin Formulation</head><p>Generally, the DT consists of three main components: the DT shadow, the DT model and the DT updating. The original features and state updates of an asset are collected to form the live digital replica of a physical or a cyber asset. The behavioral characteristics and the dynamical features of a thing are mathematically modelled, and the model is enhanced by the last shadow states. The DT model is updated based on the working states and conditions of a thing.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">Digital Twin Shadow</head><p>To represent a thing digitally in the virtual space, many immutable and mutable attributes related to different aspects such as features, capabilities, structures, working states and operating conditions can be utilized to describe this thing. In the ECPS, a physical thing ϕ or a cyber thing θ has the metadata M = ρ 1 , ρ 2 , . . . ., ρ n ρ that contains a set of n ρ immutable properties ρ. The contents of these metadata involve the design characteristics, standard limitations and the recommended rating conditions. For instance, a physical thing of DERs has power ratings, ramping capabilities, thermal withstand characteristics, voltage limitations, manufacturing information, etc. Additionally, a cyber thing as the controller has specific bandwidth, data model structure, processing capabilities, functional blocks, etc. The knowledge of the metadata is vital for DT formulation, as it provides the virtual space with the ability to be aware of a thing's original specifications, which impact the physical thing's lifetime and the cyber thing's security.</p><p>On the other hand, the working live states of an asset are updated in the virtual space when a change happens in the real space to provide the DT last update. The information is collected from sensors and controllers to update the physical asset by setting the last reported set of states</p><formula xml:id="formula_0">x rep = x rep 1 , x rep 2 , . . . , x rep n</formula><p>x , which contains n x reported states for a thing. Furthermore, the DT holds the required target of the states by recording the desired states in the DT shadow by setting the reported states x des = x des 1 , x des 2 , . . . , x des n x . The DT recognizes the reported state compliance with the desired state by calculating the difference between the desired state and the reported state, x ∆ = x des − x rep .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.">Physical System Digital Twin Model</head><p>By combining the last sensory/control updates and the model, the DT can replicate the real system digitally. The model is mathematically formulated to describe the static and dynamic features of the thing, and enhanced by full or partial information from the edge. The DT can simulate the normal and abnormal behaviors of an asset. In addition, the data-driven models leverage data analytics to describe, understand and predict the dynamical activity numerically. Exploiting the historical knowledge data, event logging and their counteractions in the deep-learning technologies can equip the DT model with the capability of recommending corrective actions during a contingency and effectively operating the ECPS during normal healthy operation.</p><p>The ECPS is assumed to contain a set of subsystems that are physically interconnected to balance the generation and demand mix and controlled through coordinated multi-agents that are linked using a cyber communication graph to ensure a common goal. The degree of the complexity of the DT model depends on the nature of the application, the possible actions and the physical asset itself.</p><p>As an example of a physical ECPS, a networked DC microgrid system DT model is introduced. Mathematically, suppose a number of physical things n ϕ has a state vector x ϕ and are monitored by a set of sensors S. The state-space representation is proposed to emulate the physical thing's characteristics with the parameter's matrices A ϕ , B ϕ , C ϕ , D ϕ . The physical twin has an output vector y ϕ that responds to the effect of an input vector U ϕ and can be described as .</p><formula xml:id="formula_1">x ϕ (t) = A ϕ x ϕ (t) + B ϕ U ϕ (t)<label>(1)</label></formula><formula xml:id="formula_2">y ϕ (t) = C ϕ x ϕ (t) + D ϕ U ϕ (t)<label>(2)</label></formula><p>The proposed ECSP DT model is divided according to the application nature into two models: a low-bandwidth DT model and high-bandwidth DT model. On one hand, the applications that require the low-bandwidth model are energy management, market operation, situational awareness monitoring and predictive maintenance. These applications are performed periodically every large time span, and they usually depend on long-term historical data to predict long-term future operation strategies and management actions. On the other hand, the high-bandwidth applications are real-time outage management, what-if contingency analysis, secondary control guidance and system restoration. The following subsections present the proposed DT model.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.1.">Low-Bandwidth Physical Model</head><p>Suppose a distribution grid has o th interconnected energy units. These energy units can be distributed generation (such as a solar, wind or conventional generator), Energy Storage Systems (ESSs) such as a battery storage system or thermal storage system, fixed loads or flexible loads (such as an electric vehicle parking garage or nanogrids). Figure <ref type="figure" target="#fig_2">2</ref> shows the low-bandwidth physical model of an energy unit <ref type="bibr" target="#b22">[23]</ref>. Generally, the energy unit can be represented as a generic energy node with an original infeed source ξ from the energy resource as the solar irradiance or the required demand. If the infeed energy is storable with capacity H, the node can represent an ESS or flexible load. If the energy cannot be stored, the node represents a generation or the fixed load and H = 0. In the case of representing the renewable resource as solar or wind and where excessive power is present, the power curtailment can be represented by ψ &lt; 0. In the case of representing the loading, ψ represents the load shedding and ψ &gt; 0. When the generic node has P ld = 0, it represents a generation mode. Additionally, if the generated power P gn = 0, the unit represents the load. If both the generation mode and loading mode exist, the node represents an ESS. The generic mathematical formulation of the o th energy unit representations is:</p><formula xml:id="formula_3">H o . SoC o = − η −1 gn,o P gn,o + η ld,o P ld,o ± ξ o + ψ o − o (SoC o − SoC (0) o )<label>(3)</label></formula><p>where SoC o and SoC</p><p>o are the state of charge and the initial state of charge of the o th energy unit. In addition, η ld and, η gn are the efficiency of the generation and loading operation, and o is a variable that represents the flexible load controllability. Table <ref type="table" target="#tab_1">1</ref> shows possible mathematical formulations for different energy unit types according to Equation (3) and from applying the energy unit constraints.  </p><formula xml:id="formula_5">Conventional H o = 0, P ld,o = 0, ψ o = 0 0 = −η −1 cgn,o P cgn,o + ξ cgn,o Renewable H o = 0, P ld,o = 0, ψ o &lt; 0 0 = −η −1 rgn,o P rgn,o + ξ rgn,o + ψ cur,o ESS ξ o = 0, ψ o = 0 H s,o . SoC s,o = −η −1 sgn,i P sgn,o + η sld,o P sld,o Fixed Load H o = 0, P gn,o = 0, ψ o &gt; 0 0 = η ld,o P ld,o − ξ ld,o + ψ shd,o Flexible Load P gn,o = 0, ψ o = 0 H f ld,o . SoC f ld,o = η f ld,o P f ld,o + ξ f ld,o − o (SoC f ld,o − SoC (0) f ld,o )</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.2.">High-Bandwidth Physical Model</head><p>The purpose of the DT is to represent the power system's dynamics and the effect of the networked microgrids on the distribution grid's point of common coupling. The DC microgrid mainly consists of four components: sources, a DC/DC converter, loads and distribution cables. The large-signal dynamical equations that represent the transient response are derived as a linear time-invariant differential equation. The main focus of this physical model is to represent the transactions among the networked microgrids. Therefore, the intra-microgrid transactions are ignored here, as they are already covered in the low-bandwidth model. Each microgrid contains several interconnected sources and loads that can be characterized by a Thevenin equivalent circuit. Thus, the individual microgrid i is modelled by a controllable voltage source and its passive components of resistance, inductance and capacitance, which are denoted as R i , L i and C i , respectively. Commonly, the networked microgrid dynamics of the i th microgrids can be described by:</p><formula xml:id="formula_6">L i d I i dt = E * i − R i I i − v i<label>(4)</label></formula><formula xml:id="formula_7">C i dv i dt = I i − g I g (<label>5</label></formula><formula xml:id="formula_8">)</formula><p>where I i is the i th microgrid converter average inductor current and E * i is the reference voltage at the i th microgrid. The microgrid is considered as two-way power flow; accordingly, I g is the current transmitted from/to microgrid i to/from distribution grid node g.</p><p>Figure <ref type="figure" target="#fig_3">3</ref> illustrates a networked DC microgrid that is under study. The grid contains two clusters of microgrids: the first cluster has five microgrids, and the second one has three microgrids. Usually, the practical DC power system is connected to the major grid via a point of common coupling (PCC). The equivalent model of each microgrid's equivalent voltage sources is shown in the bottom of Figure <ref type="figure" target="#fig_3">3</ref>, which identifies the primary control system of the DC/DC converter. Since the control objective of the secondary controllers in the cyberspace is power sharing, the voltage and the current references are formulated in the model to make the power sharing factor the reference of the controlled microgrid output.</p><p>In order to represent the power-sharing of the primary control system in the physical twin, the equivalent microgrid reference voltage can be expressed as:</p><formula xml:id="formula_9">E * i = v * i − k i P i,max x * i (6)</formula><p>where v * i and P i,max are the reference voltage and maximum power of the i th microgrid converter, k i is the constant control gain and x * i is the sharing factors that are commanded by the secondary controllers to the primary controllers.</p><p>Therefore, Equation ( <ref type="formula" target="#formula_6">4</ref>) can be rewritten as:</p><formula xml:id="formula_10">L i d I i dt = v * i − k i P i,max x * i − R i I i − v i<label>(7)</label></formula><p>Energies 2020, 13, 4762 8 of 19</p><p>The distribution grid interconnection can be represented as:</p><formula xml:id="formula_11">I i I g = Y ii Y ig Y gi Y gg v i v g (8)</formula><p>where v g is the voltage of the grid connection node, and Y is the bus admittance matrix of the grid topology.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3.">Cyber System Digital Twin Model</head><p>The cyber control edge contains the secondary distributed controllers at each power node and the tertiary controller at the PCC. As shown in Figure <ref type="figure" target="#fig_5">4</ref>, the cyber control edge includes a number of distributed controllers n θ with control states x θ that are shared through a communication cyber graph G to reach an agreement with a steady-state control law x θ,ss , which is obtained from the tertiary controller at the PCC with the state. Thus, the tertiary control objective is to satisfy x θ,ss = x * pcc . The control objective state can be the bus voltage v θ,ss = v * pcc and the power sharing factor r θ,ss = r * pcc , where r pcc = P pcc /P pcc,max , and r θ = P θ /P θ,max and P pcc,max , P θ,max are the maximum power sharing capabilities at the PCC and θ th controllers.</p><p>where * and , are the reference voltage and maximum power of the microgrid converter, is the constant control gain and * is the sharing factors that are commanded by the secondary controllers to the primary controllers.</p><p>Therefore, Equation ( <ref type="formula" target="#formula_6">4</ref>) can be rewritten as: * , *</p><p>The distribution grid interconnection can be represented as:</p><p>where is the voltage of the grid connection node, and is the bus admittance matrix of the grid topology.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3.">Cyber System Digital Twin Model</head><p>The cyber control edge contains the secondary distributed controllers at each power node and the tertiary controller at the PCC. As shown in Figure <ref type="figure" target="#fig_5">4</ref>   The cyber system can also be represented similarly to the physical system by the state-space equations as follows:</p><p>.</p><formula xml:id="formula_14">x θ (t) = A θ x θ (t) + B θ U θ (t)<label>(9)</label></formula><p>Energies 2020, 13, 4762 9 of 19</p><formula xml:id="formula_15">y θ (t) = C θ x θ (t) + D θ U θ (t)<label>(10)</label></formula><p>where A θ , B θ , C θ and D θ are the cyber system model parameters and U θ and y θ are the cyber twin input and output vectors.</p><p>The PCC control agent is considered to be the main leader of the microgrid clusters' leaders. The graph can be described by the triplet (V, E, A), where E is the communication graph edges, where E ⊆ V × V, V is the graph vertices and A ∈ R</p><formula xml:id="formula_16">( n m+1)×( n m+1</formula><p>) is an adjacency matrix, which is a weighted matrix of the links. If an agent i can send/receive information to an agent j, then the pair (i, j) ∈ E and the connection can be weighted by a factor w ij according to the following: Each cluster leader is connected to a number of m followers' controllers. Typically, the distributed secondary control system is performed by the consensus protocol. The dynamics of the consensus protocol can be formulated as a graph that has In-neighbors degrees, which can be denoted as D = diag d ij . The consensus protocol can be formulated in terms of state-space representation in terms of the Laplacian matrix L, where L = D − A, and the distributed consensus can be characterized as:</p><formula xml:id="formula_17">[A] ij = w ij &gt; 0 i f i, j ∈ E 0 otherwise (11)</formula><formula xml:id="formula_18">. x i = j=n i w ij x j − x i + b i • x pcc − x i<label>(12)</label></formula><p>.</p><formula xml:id="formula_19">X = −(L + B)•X + B1x pcc (<label>13</label></formula><formula xml:id="formula_20">)</formula><p>where n i is the node that has an accessible path to an agent i, B = diag{b i } represents the pinning matrix and b i is the leader connection weighting factor.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4.">Digital Twin Model Hybridization</head><p>The digital twin model is proposed to be a multi-purpose function. It can be used by many applications. According to the required solution, the DT model is defined by the sampling time, the known inputs and the desired outputs. The previous ECPS physical and cyber twins can be hybridized to replicate the cyber-physical system's behavior as follows:</p><formula xml:id="formula_21">      . X θ . X ϕ       = A θ 0 B ϕ C θ A ϕ X θ X ϕ + B θ 0 U ϕ (<label>14</label></formula><formula xml:id="formula_22">)</formula><formula xml:id="formula_23">y θϕ = 0 B ϕ X θ X ϕ (<label>15</label></formula><formula xml:id="formula_24">)</formula><p>where y θϕ is the hybrid twin model output. Using the hybrid twin models, the unknown states and the forecasted behavior can be predicted based on the present shadow states. The digital twin implementation in the cloud virtual space and its data transactions are clarified in the next sections.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">ECPS Things-To-Cloud Service Transactions</head><p>To implement the digital twin, the model's degree of complexity should be carefully considered to avoid adding extra complexity to the system. The proposed digital twin uses the state-space representation of the ECSP by aggregating the individual microgrid resources into a single equivalent model. That will reduce the communication and the computational burden without reducing the benefits of the potential applications and solutions. As shown in Figure <ref type="figure" target="#fig_7">5</ref>, the IoT GG makes decisions locally within the microgrid, but it will be kept aware of the global centric objective with regular over-the-air programming (OTA) updates of its settings.</p><p>The ECSP is represented in the cloud by the sensor measurements from the physical assets ϕ and the control states from the cyber assets θ. Figure <ref type="figure" target="#fig_7">5</ref> depicts the AWS cloud hosting the energy IoT, computing services and their transactions. Suppose the distribution grid has n microgrid (µG) clusters, each µG cluster has m microgrids and the i th µG has th assets. Each asset is connected to the microgrid main bus by an interlinking power electronics converter IC, and each µG is linked to the distribution grid by an interlinking converter IC i .</p><p>On one hand, the microgrid physical assets can be classified into four main types, the distributed generator (DG), ESS, fixed load (LD) and flexible loads (FLD). An asset o is monitored by a current transformer C.T and voltage transformer V.T, which are used to calculate various physical power system states using µPMUs. The asset physical state is represented by a set of calculated parameters x ϕ = P, Q, f , V that are the active power, reactive power, power frequency and voltage, respectively.</p><p>On the other hand, the cyberspace is a set of distributed controllers, which are communicating with each other to cooperatively satisfy a control objective x θ . The control objective can be active/reactive power sharing, voltage regulation and/or frequency synchronization. This is cooperatively performed by the interlinking converters' secondary distributed controllers ICC. The ICCs are connected via cyber communication links, and the control states interpret the cyberspace transactions alongside the interactions with the physical assets. The AWS GG is used to extend the cloud system functionality to the IoT devices (µPMUs, ICC) to perform the data gathering and analysis and act locally on the cyber edge. The IoT GG channels are proposed to perform higher-speed calculations locally to be able to act quickly in the case of a critical power system status. The data transaction between the sensors, controllers' edge and cloud is implemented based on the message queuing telemetry transport (MQTT) protocol. To preserve privacy and reduce the complexity and computational burden, the data pipelines service is used to filter and prepare the data for the cloud computing services. The IoT core along with the lambda serviceless functions is implemented to easily and securely interact with various cloud computing applications.</p><p>Besides the DT functions, different services on the cloud are proposed to build different applications. For instance, the AWS SageMaker is used to build, train and test the deep-learning models that are launched on the edge cyberspace. Data filtering, routing and management services are implemented to prepare the data for each application according to the requirements. AWS SageMaker is also used to build applications for the centric guidance to the distributed controllers; what-if contingency scenarios for outage management provide security auditing based on the anomaly detection functionality. In addition, IoT data analytics and data storage are used to implement offline applications for power system planning and physical assets' predictive maintenance. The cyber things can be used to coordinate between different applications.</p><p>Figure <ref type="figure" target="#fig_10">6</ref> illustrates the cyber/physical thing registration process on the IoT core on the AWS cloud. The IoT Software Development Kit (SDK) is launched on the physical or the cyber asset. The asset registry contains the asset policy, which is used to authorize the device to perform the IoT connectivity. Each asset has the required certificates and keys that are required to initiate the message transactions. The communication is implemented by the asset gateway using MQTT WebSocket or hypertext transfer protocol secure (HTTPs) protocols, and it should be authorized by the IoT core to verify the thing's identity. Then, the gateway sends the message to the rule engine, which is responsible for assessing the incoming messages published into the IoT core. That determines the action of structured query language (SQL) filtering or rerouting the data to different cloud services based on pre-defined settings.</p><p>implemented to easily and securely interact with various cloud computing applications.</p><p>Besides the DT functions, different services on the cloud are proposed to build different applications. For instance, the AWS SageMaker is used to build, train and test the deep-learning models that are launched on the edge cyberspace. Data filtering, routing and management services are implemented to prepare the data for each application according to the requirements. AWS SageMaker is also used to build applications for the centric guidance to the distributed controllers; what-if contingency scenarios for outage management provide security auditing based on the anomaly detection functionality. In addition, IoT data analytics and data storage are used to implement offline applications for power system planning and physical assets' predictive maintenance. The cyber things can be used to coordinate between different applications.</p><p>Figure <ref type="figure" target="#fig_10">6</ref> illustrates the cyber/physical thing registration process on the IoT core on the AWS cloud. The IoT Software Development Kit (SDK) is launched on the physical or the cyber asset. The asset registry contains the asset policy, which is used to authorize the device to perform the IoT connectivity. Each asset has the required certificates and keys that are required to initiate the message transactions. The communication is implemented by the asset gateway using MQTT WebSocket or hypertext transfer protocol secure (HTTPs) protocols, and it should be authorized by the IoT core to verify the thing's identity. Then, the gateway sends the message to the rule engine, which is responsible for assessing the incoming messages published into the IoT core. That determines the action of structured query language (SQL) filtering or rerouting the data to different cloud services based on pre-defined settings. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DG ESS</head><note type="other">Load Flexible Load Sensors &amp; Controllers</note></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>AWS IoT Greengrass</head><p>IoT GG DG channel</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>MQTT messages</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>IoT GG ESS channel</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>IoT GG LD channel</head><p>IoT GG LD channel   The vital process of the DT is the update process for the device shadow. The shadow state of an asset is a JavaScript object notation (JSON) file that is used to store/retrieve the last state of a thing. The shadow can be accessed regardless of whether the thing is connected to the Internet or not. It contains the shadow desired and reported states, immutable metadata, updated version, transaction token and timestamp. The vital process of the DT is the update process for the device shadow. The shadow state of an asset is a JavaScript object notation (JSON) file that is used to store/retrieve the last state of a thing. The shadow can be accessed regardless of whether the thing is connected to the Internet or not. It contains the shadow desired and reported states, immutable metadata, updated version, transaction token and timestamp.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>GG Group</head><note type="other">Assets Cluster Things Sense&amp;Act IoT Core Data</note><p>The Lambda serviceless function automatically executes a predefined logic function when required without provisioning. The messages are used later for different cloud computing solutions and end-user/operator applications. The IoT application programming interface is used to interact with the data for different applications.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Digital Twin Implementation and Results</head><p>The ECPS DT is demonstrated by implementing the physical and the cyber layers of the networked microgrids (MG) using interconnected embedded computers as a multi-agent platform. Figure <ref type="figure" target="#fig_11">7</ref> shows eight microgrids' agents and a single PCC agent that are executed on nine Raspberry Pis™ and communicate using Wi-Fi. The Data Distribution Service (DDS) communication middleware is used to launch the data sharing among the distributed controllers/sensors as a cyber layer. The DDS uses the publication/subscription mechanism without a message broker for the data sharing, which guarantees high-speed connectivity among the networked microgrids, and communication configuration is performed in extensible markup language (XML) files for each agent. The Python programming language is used beside the AWS cloud system. The ECPS-to-AWS communication is performed via the Message Queuing Telemetry Transport (MQTT) protocol, and the data are initially hosted on the AWS IoT core <ref type="bibr" target="#b15">[16]</ref>.</p><p>Figure <ref type="figure" target="#fig_14">8</ref> shows the distributed consensus control algorithm that is implemented on each control agent in the cyber system and its interaction with the DT on the AWS cloud. Firstly, the agent is initialized with the adjacency weighting factors. Then, DDS communication is used to listen to the agent's neighbor and continuously check for an event that requires a consensus on new sharing power.</p><p>After the agent neighbor's data are accepted, the local control objective is updated based on the consensus rule that is discussed in Figure <ref type="figure" target="#fig_5">4</ref> to agree on the leader steady state. Finally, the pre-event The Lambda serviceless function automatically executes a predefined logic function when required without provisioning. The messages are used later for different cloud computing solutions and end-user/operator applications. The IoT application programming interface is used to interact with the data for different applications.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Digital Twin Implementation and Results</head><p>The ECPS DT is demonstrated by implementing the physical and the cyber layers of the networked microgrids (MG) using interconnected embedded computers as a multi-agent platform. Figure <ref type="figure" target="#fig_11">7</ref> shows eight microgrids' agents and a single PCC agent that are executed on nine Raspberry Pis™ and communicate using Wi-Fi. The Data Distribution Service (DDS) communication middleware is used to launch the data sharing among the distributed controllers/sensors as a cyber layer. The DDS uses the publication/subscription mechanism without a message broker for the data sharing, which guarantees high-speed connectivity among the networked microgrids, and communication configuration is performed in extensible markup language (XML) files for each agent. The Python programming language is used beside the AWS cloud system. The ECPS-to-AWS communication is performed via the Message Queuing Telemetry Transport (MQTT) protocol, and the data are initially hosted on the AWS IoT core <ref type="bibr" target="#b15">[16]</ref>.</p><p>Figure <ref type="figure" target="#fig_14">8</ref> shows the distributed consensus control algorithm that is implemented on each control agent in the cyber system and its interaction with the DT on the AWS cloud. Firstly, the agent is initialized with the adjacency weighting factors. Then, DDS communication is used to listen to the agent's neighbor and continuously check for an event that requires a consensus on new sharing power.</p><p>After the agent neighbor's data are accepted, the local control objective is updated based on the consensus rule that is discussed in Figure <ref type="figure" target="#fig_5">4</ref> to agree on the leader steady state. Finally, the pre-event and post-event states are reported by using the MQTT update function on the AWS cloud. Moreover, the desired state or DT-based guides are submitted to the edge via the MQTT get function. These signals can be configured according to the applicable nature of the DT.</p><p>Figure <ref type="figure" target="#fig_13">9</ref> shows the implemented DT on the cloud system. Practically, the AWS SageMaker is used to perform the required computations and DT functions. This service can hold parallel instances of computation by utilizing the IoT core shadow data or the data stored in the database. The parallel instances can be implemented and scaled according to the required application. The state-space modelling of the physical and cyber twin model is implemented and imported as functions to implement the low and high-bandwidth physical DT alongside the cyber DT models on the AWS SageMaker. These models acquire the up-to-date shadow from the AWS IoT core service to update their estimations and configuration every certain time.</p><p>To reduce the communication bandwidth and minimize the computational burden, the AWS Lambda function is used to trigger the application by continuously monitoring the detected event.</p><p>Using the models previously discussed in ( <ref type="formula" target="#formula_3">3</ref>), ( <ref type="formula" target="#formula_10">7</ref>)-( <ref type="formula" target="#formula_13">8</ref>) and ( <ref type="formula" target="#formula_18">12</ref>)-( <ref type="formula" target="#formula_23">15</ref>), the digital replica of the energy cyber physical system is constructed to be utilized by different applications. Both the reported sensor measurements (voltages v i and injected power P i ) and the reported post-event cyber states (x rep i,post ) are ported to the online Digital Twin models. According to the applicable nature, the desired commanding and decisions can be submitted back to the edge to achieve the requirements.</p><p>In the same way, after the application decisions are made, the desired commands are set back to the desired shadow state on the IoT core. The controller on the edge gets the desired states as centric oversight guidelines, which are used to guarantee the global system operation objectives. Thus, the DT creates digital parallel environments for the safe application of the control command on the twin before giving the edge controllers the final guides.</p><p>Energies 2020, 13, x FOR PEER REVIEW 13 of 19 and post-event states are reported by using the MQTT update function on the AWS cloud. Moreover, the desired state or DT-based guides are submitted to the edge via the MQTT get function. These signals can be configured according to the applicable nature of the DT. Figure <ref type="figure" target="#fig_13">9</ref> shows the implemented DT on the cloud system. Practically, the AWS SageMaker is used to perform the required computations and DT functions. This service can hold parallel instances of computation by utilizing the IoT core shadow data or the data stored in the database. The parallel instances can be implemented and scaled according to the required application. The state-space modelling of the physical and cyber twin model is implemented and imported as functions to implement the low and high-bandwidth physical DT alongside the cyber DT models on the AWS SageMaker. These models acquire the up-to-date shadow from the AWS IoT core service to update their estimations and configuration every certain time.</p><p>To reduce the communication bandwidth and minimize the computational burden, the AWS Lambda function is used to trigger the application by continuously monitoring the detected event.</p><p>Using the models previously discussed in ( <ref type="formula" target="#formula_3">3</ref>), ( <ref type="formula" target="#formula_10">7</ref>)-( <ref type="formula" target="#formula_13">8</ref>) and ( <ref type="formula" target="#formula_18">12</ref>)-( <ref type="formula" target="#formula_23">15</ref>), the digital replica of the energy cyber physical system is constructed to be utilized by different applications. Both the reported sensor measurements (voltages and injected power ) and the reported post-event cyber states ( , ) are ported to the online Digital Twin models. According to the applicable nature, the desired commanding and decisions can be submitted back to the edge to achieve the requirements.</p><p>In the same way, after the application decisions are made, the desired commands are set back to the desired shadow state on the IoT core. The controller on the edge gets the desired states as centric oversight guidelines, which are used to guarantee the global system operation objectives. Thus, the DT creates digital parallel environments for the safe application of the control command on the twin before giving the edge controllers the final guides.        The first case study is implemented using the low-bandwidth model. Two clusters of microgrids are implemented on MATLAB/SIMULINK as a detailed physical model, and the CPS data are sent to the AWS cloud IoT core in terms of shadow states. The system contains a collection of diesel generators (conventional generators), PV-wind mixtures (renewable generators), ESSs and loads (fixed and flexible). On the other hand, the AWS has the state-space representation as shown in Table <ref type="table" target="#tab_1">1</ref> to construct the physical twin and the system in ( <ref type="formula" target="#formula_18">12</ref>)- <ref type="bibr" target="#b14">(15)</ref> to represent the cyber model. The model uses the loading profile and the forecasted renewable power to estimate the dispatching of the resources.</p><p>Figure <ref type="figure" target="#fig_0">10</ref> shows matching between the DT model and the physical states. The low-bandwidth model has a 15 min time slot for the AWS shadow update rate. Figure <ref type="figure" target="#fig_0">10a</ref> depicts a close relationship between the digital twin estimated states and the physical states of first cluster states, which are the aggregated demand, conventional generation, renewable generation, aggregated ESS charge/discharge power and state of charge. The second cluster, which is shown in Figure <ref type="figure" target="#fig_0">10b</ref>, presents the ability of the DT to mimic the physical response. The high-bandwidth twin model is evaluated as shown in Figures <ref type="figure" target="#fig_0">11 and 12</ref>.</p><p>In the second case study, the secondary distributed control system controls the microgrids' interlinking converters to share the power among the microgrids to support the voltage at the PCC. The implemented control agents on the embedded computers send their information (sharing factors) to the AWS cloud. The implemented DT in AWS SageMaker uses the sharing factor shadows to estimate the voltage at each bus in the interconnected microgrids. The figures show that the DT can replicate the actual system. A comparison is made between the cyber states and the AWS shadow updates, which is updated every 5 s. Figure <ref type="figure" target="#fig_0">11</ref> illustrates the power sharing factor consensus under two consecutive changes (0.5 and 0.85 per unit in the reference at the PCC. The first case study is implemented using the low-bandwidth model. Two clusters of microgrids are implemented on MATLAB/SIMULINK as a detailed physical model, and the CPS data are sent to the AWS cloud IoT core in terms of shadow states. The system contains a collection of diesel generators (conventional generators), PV-wind mixtures (renewable generators), ESSs and loads (fixed and flexible). On the other hand, the AWS has the state-space representation as shown in Table <ref type="table" target="#tab_1">1</ref> to construct the physical twin and the system in ( <ref type="formula" target="#formula_18">12</ref>)- <ref type="bibr" target="#b14">(15)</ref> to represent the cyber model. The model uses the loading profile and the forecasted renewable power to estimate the dispatching of the resources.</p><p>Figure <ref type="figure" target="#fig_0">10</ref> shows matching between the DT model and the physical states. The low-bandwidth model has a 15 min time slot for the AWS shadow update rate. Figure <ref type="figure" target="#fig_0">10a</ref> depicts a close relationship between the digital twin estimated states and the physical states of first cluster states, which are the aggregated demand, conventional generation, renewable generation, aggregated ESS charge/discharge power and state of charge. The second cluster, which is shown in Figure <ref type="figure" target="#fig_0">10b</ref>, presents the ability of the DT to mimic the physical response. The high-bandwidth twin model is evaluated as shown in Figures <ref type="figure" target="#fig_0">11 and 12</ref>.</p><p>In the second case study, the secondary distributed control system controls the microgrids' interlinking converters to share the power among the microgrids to support the voltage at the PCC. The implemented control agents on the embedded computers send their information (sharing factors) to the AWS cloud. The implemented DT in AWS SageMaker uses the sharing factor shadows to estimate the voltage at each bus in the interconnected microgrids. The figures show that the DT can replicate the actual system. A comparison is made between the cyber states and the AWS shadow updates, which is updated every 5 s. Figure <ref type="figure" target="#fig_0">11</ref> illustrates the power sharing factor consensus under two consecutive changes (0.5 and 0.85 per unit in the reference at the PCC.  The delay between the cyber edge states (black) and the shadow updates (red dots) is due to the Wi-Fi communications. The provisioned shadow states are used to drive the high-bandwidth model to mimic the physical voltage measurements at each bus, which show a very close response as illustrated in Figure <ref type="figure" target="#fig_0">12</ref>.   The delay between the cyber edge states (black) and the shadow updates (red dots) is due to the Wi-Fi communications. The provisioned shadow states are used to drive the high-bandwidth model to mimic the physical voltage measurements at each bus, which show a very close response as illustrated in Figure <ref type="figure" target="#fig_0">12</ref>. The delay between the cyber edge states (black) and the shadow updates (red dots) is due to the Wi-Fi communications. The provisioned shadow states are used to drive the high-bandwidth model to mimic the physical voltage measurements at each bus, which show a very close response as illustrated in Figure <ref type="figure" target="#fig_0">12</ref>.    </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Conclusions</head><p>This paper provides a methodology for the design of digital twin models for the power system components and the communication topology. The power system sources, as well as clusters of interconnected microgrids that represent the main building blocks of future power systems, were modelled. The implementation of the models on the Amazon Web Service and their interactions with the physical components were demonstrated. The results showed the ability of the proposed models to be a live digital replica of future power systems. The authors are currently developing a combination of deep learning and the DT to implement a wide-area situational awareness system by considering the stability, reliability and resiliency of the globally interconnected power system. The proposed DT aims to guarantee to mimic the dynamics and events in real time. Although the DT's purpose is not the accuracy of reconstructing states, both the low-bandwidth DT and the highbandwidth DT were able to accurately replicate the cyber-physical system's live states, as shown by the average error not exceeding 4% and the maximum error being 9.2%.   </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Conclusions</head><p>This paper provides a methodology for the design of digital twin models for the power system components and the communication topology. The power system sources, as well as clusters of interconnected microgrids that represent the main building blocks of future power systems, were modelled. The implementation of the models on the Amazon Web Service and their interactions with the physical components were demonstrated. The results showed the ability of the proposed models to be a live digital replica of future power systems. The authors are currently developing a combination of deep learning and the DT to implement a wide-area situational awareness system by considering the stability, reliability and resiliency of the globally interconnected power system. The proposed DT aims to guarantee to mimic the dynamics and events in real time. Although the DT's purpose is not the accuracy of reconstructing states, both the low-bandwidth DT and the high-bandwidth DT were able to accurately replicate the cyber-physical system's live states, as shown by the average error not exceeding 4% and the maximum error being 9.2%.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. The architecture of the proposed energy cyber-physical system (ECPS) digital twin.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. The architecture of the proposed energy cyber-physical system (ECPS) digital twin.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2 .</head><label>2</label><figDesc>Figure 2. Low-bandwidth physical model of the digital twin (DT).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 .</head><label>3</label><figDesc>Figure 3. Networked microgrid equivalent circuit for physical twin model.Figure 3. Networked microgrid equivalent circuit for physical twin model.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 3 .</head><label>3</label><figDesc>Figure 3. Networked microgrid equivalent circuit for physical twin model.Figure 3. Networked microgrid equivalent circuit for physical twin model.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 4 .</head><label>4</label><figDesc>Figure 4. An example of a cyber edge space model.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 5 .</head><label>5</label><figDesc>Figure 5. Data transactions between ECPS and cloud services.Figure 5. Data transactions between ECPS and cloud services.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 5 .</head><label>5</label><figDesc>Figure 5. Data transactions between ECPS and cloud services.Figure 5. Data transactions between ECPS and cloud services.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Energies 2020 , 19 Figure 6 .</head><label>2020196</label><figDesc>Figure 6. Physical/cyber thing registration on the IoT core.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Figure 6 .</head><label>6</label><figDesc>Figure 6. Physical/cyber thing registration on the IoT core.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Figure 7 .</head><label>7</label><figDesc>Figure 7. Practical ECPS DT implementation.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Figure 7 .</head><label>7</label><figDesc>Figure 7. Practical ECPS DT implementation.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13"><head>Figure 9 .</head><label>9</label><figDesc>Figure 9. DT implementation on AWS cloud.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14"><head>Figure 8 .</head><label>8</label><figDesc>Figure 8. Distributed controller algorithm on the edge interaction with the DT on the AWS cloud.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15"><head>Figure 9 .</head><label>9</label><figDesc>Figure 9. DT implementation on AWS cloud.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16"><head>Figure 9 .</head><label>9</label><figDesc>Figure 9. DT implementation on AWS cloud.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17"><head>Figure 10 .</head><label>10</label><figDesc>Figure 10. Cont.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_18"><head>Figure 10 .</head><label>10</label><figDesc>Figure 10. A comparison between the low-bandwidth physical DT model and the physical measurements: (a) MG cluster 1; (b) MG cluster 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_19"><head>Figure 11 .</head><label>11</label><figDesc>Figure 11. A comparison between the cyber states and the shadow states on the AWS.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_20"><head>1</head><label></label><figDesc>Sharing consensus@0.5p.u.Sharing consensus@0.85p.u.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_21"><head>Figure 10 .</head><label>10</label><figDesc>Figure 10. A comparison between the low-bandwidth physical DT model and the physical measurements: (a) MG cluster 1; (b) MG cluster 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_22"><head>Energies 2020 , 19 Figure 10 .</head><label>20201910</label><figDesc>Figure 10. A comparison between the low-bandwidth physical DT model and the physical measurements: (a) MG cluster 1; (b) MG cluster 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_23"><head>Figure 11 .</head><label>11</label><figDesc>Figure 11. A comparison between the cyber states and the shadow states on the AWS.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_24"><head>1</head><label></label><figDesc>Sharing consensus@0.5p.u.Sharing consensus@0.85p.u.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_25"><head>Figure 11 .</head><label>11</label><figDesc>Figure 11. A comparison between the cyber states and the shadow states on the AWS.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_26"><head>Figure 12 .</head><label>12</label><figDesc>Figure 12. A comparison between the high-bandwidth cyber DT model and the cyber states.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_27"><head>Author</head><label></label><figDesc>Contributions: Conceptualization, A.S.; methodology, A.S.; software, A.S.; validation, A.S; formal analysis, A.S. and S.F.; investigation, A.S.; resources, A.S.; data curation, A.S. and S.F.; writing-original draft preparation, A.S. and S.F.; writing-review and editing, A.S., S.F. and O.M.; visualization, A.S.; supervision, O.M.; project administration, O.M.; funding acquisition, O.M. All authors have read and agreed to the published version of the manuscript. Funding: This research received no external funding. Acknowledgements: This work was partially funded by grants from the Office of Naval Research and the US Department of Energy.Conflicts of Interest:The authors declare no conflict of interest.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_28"><head>Figure 12 .</head><label>12</label><figDesc>Figure 12. A comparison between the high-bandwidth cyber DT model and the cyber states.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 .</head><label>1</label><figDesc>Energy unit mathematical formulation.</figDesc><table><row><cell>Type</cell><cell>Constraints</cell><cell>State-Space Model</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>agreement with a steady-state control law , , which is obtained from the tertiary controller at the PCC with the state. Thus, the tertiary control objective is to satisfy ,</figDesc><table><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell cols="6">, the cyber control edge includes a number of</cell></row><row><cell cols="2">distributed controllers</cell><cell cols="3">with control states</cell><cell cols="6">that are shared through a communication cyber</cell></row><row><cell>graph</cell><cell cols="10">to reach an and the power sharing factor</cell></row><row><cell>,</cell><cell>*  , where</cell><cell>⁄</cell><cell>,</cell><cell>, and</cell><cell>⁄</cell><cell>,</cell><cell>and</cell><cell>,</cell><cell>, ,</cell><cell>are the maximum</cell></row><row><cell cols="5">power sharing capabilities at the PCC and</cell><cell cols="2">controllers.</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell cols="2">Microgrid Cluster 1</cell><cell>ZC7</cell><cell>R5 L5</cell><cell>E5</cell><cell>ZC6</cell><cell cols="2">R4 L4</cell><cell>E4</cell></row><row><cell></cell><cell>RPCC LPCC</cell><cell>ZC1</cell><cell></cell><cell></cell><cell>ZC2</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Epcc</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell>ZC5</cell><cell></cell><cell></cell><cell>ZC4</cell><cell></cell><cell></cell><cell>ZC3</cell></row><row><cell></cell><cell>Equivalent</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Circuit @ PCC</cell><cell></cell><cell></cell><cell>R1</cell><cell></cell><cell></cell><cell>R2</cell><cell></cell><cell></cell><cell>R3</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell>L1</cell><cell></cell><cell></cell><cell>L2</cell><cell></cell><cell></cell><cell>L3</cell></row><row><cell></cell><cell></cell><cell>ZC8</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell>E1</cell><cell></cell><cell></cell><cell>E2</cell><cell></cell><cell></cell><cell>E3</cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell cols="2">ZC10</cell><cell></cell><cell></cell><cell>ZC12</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Microgrid</cell><cell>ZC9</cell><cell></cell><cell></cell><cell>ZC11</cell><cell></cell><cell></cell><cell></cell><cell>ZC13</cell><cell></cell></row><row><cell></cell><cell>Cluster 2</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell>R6</cell><cell></cell><cell></cell><cell>R7</cell><cell></cell><cell></cell><cell></cell><cell>R8</cell><cell></cell></row><row><cell></cell><cell></cell><cell>L6</cell><cell></cell><cell></cell><cell>L7</cell><cell></cell><cell></cell><cell></cell><cell>L8</cell><cell></cell></row><row><cell></cell><cell>E6</cell><cell></cell><cell></cell><cell></cell><cell>E7</cell><cell></cell><cell></cell><cell>E8</cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell>*</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell>*</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>,</cell><cell></cell><cell></cell><cell></cell><cell>PWM</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table><note>* . The control objective state can be the bus voltage , . *</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head></head><label></label><figDesc>pipelines    </figDesc><table><row><cell cols="2">Serviceless Computing function</cell></row><row><cell cols="2">Cloud Storage &amp; Computation</cell></row><row><cell>Physical Twin Function</cell><cell></cell></row><row><cell>Physical System State-Space Model Cyber Twin Function Cyber System</cell><cell>Digital Twin Functions</cell></row><row><cell>State-Space Model</cell><cell></cell></row><row><cell cols="2">AWS SageMaker Deep Learning Services</cell></row><row><cell cols="2">Getting, Filtering, Updating IoT Shadow</cell></row><row><cell cols="2">Centric Oversight for the Control</cell></row><row><cell cols="2">System Targets</cell></row><row><cell cols="2">Distributed Control System Security</cell></row><row><cell>Auditing</cell><cell></cell></row><row><cell>What-If Scenarios</cell><cell>Data Analytics</cell></row><row><cell>Data Storage</cell><cell>Things Graph</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head></head><label></label><figDesc>Energies 2020, 13, x FOR PEER REVIEW 14 of 19 Distributed controller algorithm on the edge interaction with the DT on the AWS cloud.</figDesc><table><row><cell>Control Edge</cell><cell></cell><cell>Initialize Agent i</cell><cell>AWS Cloud</cell></row><row><cell>Subscribe</cell><cell cols="3">Reading neighbor's state for agents j</cell></row><row><cell></cell><cell></cell><cell>Check state update event</cell><cell>No</cell><cell>No update Maintain</cell></row><row><cell></cell><cell></cell><cell>Yes</cell></row><row><cell cols="4">The neighbor's data are accepted for</cell></row><row><cell></cell><cell></cell><cell cols="2">information update</cell></row><row><cell>Publish</cell><cell>1</cell><cell cols="2">Information update .</cell></row><row><cell></cell><cell cols="3">Consensus on the leader state ,</cell></row><row><cell cols="3">Record post-event state:</cell><cell>1</cell></row><row><cell cols="4">Update the IoT shadow on AWS by</cell><cell>Get</cell></row><row><cell></cell><cell cols="3">reporting the new state:</cell></row><row><cell></cell><cell></cell><cell>,</cell><cell>Update</cell></row><row><cell cols="4">Send the updated state to the primary</cell></row><row><cell cols="4">controller of the DC/DC converter</cell></row><row><cell>Control Edge</cell><cell></cell><cell></cell><cell>AWS Cloud</cell></row><row><cell cols="4">Figure 8. AWS SageMaker Initialization</cell><cell>Control Edge</cell></row><row><cell cols="4">Importing State-Space, Physical Twin and Cyber Twin</cell></row><row><cell cols="4">Modeling Functions</cell></row><row><cell cols="4">Connect to IoT Core Data</cell><cell>Update Get</cell></row><row><cell cols="4">Continuously Check λ Function: Event Detected = True</cell></row><row><cell cols="4">High-bandwidth and Low-bandwidth Twins:</cell></row><row><cell cols="2">Reported Cyber</cell><cell cols="2">Reported sensor's</cell></row><row><cell cols="2">System States</cell><cell cols="2">mesurement</cell></row><row><cell>,</cell><cell></cell><cell></cell><cell>i , i</cell></row><row><cell cols="2">ECPS low-bandwidth</cell><cell cols="2">ECPS high-bandwidth</cell></row><row><cell>Twin Model</cell><cell></cell><cell></cell><cell>Twin Model</cell></row><row><cell cols="2">Eq.(3), (12)-(15)</cell><cell cols="2">Eq.(7)-(8), (12)-(15)</cell></row><row><cell cols="4">APPLICATIONS:  What-if Analysis  Predictive Maintenance  Outage Management  Wide-Area Fault Tolerant  Market Management</cell><cell>Control Edge</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head></head><label></label><figDesc>Distributed controller algorithm on the edge interaction with the DT on the AWS cloud.</figDesc><table><row><cell>Energies 2020, 13, x FOR PEER REVIEW</cell><cell></cell><cell></cell><cell>14 of 19</cell></row><row><cell>Control Edge</cell><cell></cell><cell>Initialize Agent i</cell><cell>AWS Cloud</cell></row><row><cell>Subscribe</cell><cell cols="3">Reading neighbor's state for agents j</cell></row><row><cell></cell><cell></cell><cell>Check state update event</cell><cell>No</cell><cell>No update Maintain</cell></row><row><cell></cell><cell></cell><cell>Yes</cell></row><row><cell cols="4">The neighbor's data are accepted for</cell></row><row><cell></cell><cell></cell><cell cols="2">information update</cell></row><row><cell>Publish</cell><cell>1</cell><cell cols="2">Information update .</cell></row><row><cell></cell><cell cols="3">Consensus on the leader state ,</cell></row><row><cell cols="3">Record post-event state:</cell><cell>1</cell></row><row><cell cols="4">Update the IoT shadow on AWS by</cell><cell>Get</cell></row><row><cell></cell><cell cols="3">reporting the new state:</cell></row><row><cell></cell><cell></cell><cell>,</cell><cell>Update</cell></row><row><cell cols="4">Send the updated state to the primary</cell></row><row><cell cols="4">controller of the DC/DC converter</cell></row><row><cell>Control Edge</cell><cell></cell><cell></cell><cell>AWS Cloud</cell></row><row><cell cols="4">Figure 8. AWS SageMaker Initialization</cell><cell>Control Edge</cell></row><row><cell cols="4">Importing State-Space, Physical Twin and Cyber Twin</cell></row><row><cell cols="4">Modeling Functions</cell></row><row><cell cols="4">Connect to IoT Core Data</cell><cell>Update Get</cell></row><row><cell cols="4">Continuously Check λ Function: Event Detected = True</cell></row><row><cell cols="4">High-bandwidth and Low-bandwidth Twins:</cell></row><row><cell cols="2">Reported Cyber</cell><cell cols="2">Reported sensor's</cell></row><row><cell cols="2">System States</cell><cell cols="2">mesurement</cell></row><row><cell>,</cell><cell></cell><cell></cell><cell>i , i</cell></row><row><cell cols="2">ECPS low-bandwidth</cell><cell cols="2">ECPS high-bandwidth</cell></row><row><cell>Twin Model</cell><cell></cell><cell></cell><cell>Twin Model</cell></row><row><cell cols="2">Eq.(3), (12)-(15)</cell><cell cols="2">Eq.(7)-(8), (12)-(15)</cell></row><row><cell cols="4">APPLICATIONS:  What-if Analysis  Predictive Maintenance  Outage Management  Wide-Area Fault Tolerant  Market Management</cell><cell>Control Edge</cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Acknowledgments: This work was partially funded by grants from the Office of Naval Research and the US Department of Energy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conflicts of Interest:</head><p>The authors declare no conflict of interest. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Nomenclature</head></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0" />			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Review on Multi-Objective Control Strategies for Distributed Generation on Inverter-Based Microgrids</title>
		<author>
			<persName><forename type="first">Óscar</forename><surname>Gonzales-Zurita</surname></persName>
			<idno type="ORCID">0000-0002-6726-1243</idno>
		</author>
		<author>
			<persName><forename type="first">Jean-Michel</forename><surname>Clairand</surname></persName>
			<idno type="ORCID">0000-0001-6448-4401</idno>
		</author>
		<author>
			<persName><forename type="first">Elisa</forename><surname>Peñalvo-López</surname></persName>
			<idno type="ORCID">0000-0002-3143-822X</idno>
		</author>
		<author>
			<persName><forename type="first">Guillermo</forename><surname>Escrivá-Escrivá</surname></persName>
			<idno type="ORCID">0000-0002-3202-4571</idno>
		</author>
		<idno type="DOI">10.3390/en13133483</idno>
	</analytic>
	<monogr>
		<title level="j">Energies</title>
		<title level="j" type="abbrev">Energies</title>
		<idno type="ISSNe">1996-1073</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">13</biblScope>
			<biblScope unit="page">3483</biblScope>
			<date type="published" when="2020-07-06" />
			<publisher>MDPI AG</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A Cyber-Physical Systems architecture for Industry 4.0-based manufacturing systems</title>
		<author>
			<persName><forename type="first">Jay</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Behrad</forename><surname>Bagheri</surname></persName>
			<idno type="ORCID">0000-0003-2175-0946</idno>
		</author>
		<author>
			<persName><forename type="first">Hung-An</forename><surname>Kao</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.mfglet.2014.12.001</idno>
	</analytic>
	<monogr>
		<title level="j">Manufacturing Letters</title>
		<title level="j" type="abbrev">Manufacturing Letters</title>
		<idno type="ISSN">2213-8463</idno>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="18" to="23" />
			<date type="published" when="2015-01" />
			<publisher>Elsevier BV</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Participatory Sensing</title>
		<author>
			<persName><forename type="first">Jan</forename><surname>Höller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Vlasios</forename><surname>Tsiatsis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Catherine</forename><surname>Mulligan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stamatis</forename><surname>Karnouskos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stefan</forename><surname>Avesand</surname></persName>
		</author>
		<author>
			<persName><forename type="first">David</forename><surname>Boyle</surname></persName>
		</author>
		<idno type="DOI">10.1016/b978-0-12-407684-6.00015-2</idno>
	</analytic>
	<monogr>
		<title level="m">From Machine-To-Machine to the Internet of Things</title>
				<imprint>
			<publisher>Elsevier</publisher>
			<date type="published" when="2014" />
			<biblScope unit="page" from="295" to="305" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Internet of Things for Smart Cities</title>
		<author>
			<persName><forename type="first">Andrea</forename><surname>Zanella</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Nicola</forename><surname>Bui</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Angelo</forename><surname>Castellani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Lorenzo</forename><surname>Vangelista</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Michele</forename><surname>Zorzi</surname></persName>
		</author>
		<idno type="DOI">10.1109/jiot.2014.2306328</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Internet of Things Journal</title>
		<title level="j" type="abbrev">IEEE Internet Things J.</title>
		<idno type="ISSNe">2372-2541</idno>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="22" to="32" />
			<date type="published" when="2014-02" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Internet of Things (IoT) Platform for Multi-Topic Messaging</title>
		<author>
			<persName><forename type="first">Mahmoud</forename><surname>Hussein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ahmed</forename><forename type="middle">I</forename><surname>Galal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Emad</forename><surname>Abd-Elrahman</surname></persName>
			<idno type="ORCID">0000-0002-8340-9164</idno>
		</author>
		<author>
			<persName><forename type="first">Mohamed</forename><surname>Zorkany</surname></persName>
			<idno type="ORCID">0000-0003-1077-7799</idno>
		</author>
		<idno type="DOI">10.3390/en13133346</idno>
	</analytic>
	<monogr>
		<title level="j">Energies</title>
		<title level="j" type="abbrev">Energies</title>
		<idno type="ISSNe">1996-1073</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">13</biblScope>
			<biblScope unit="page">3346</biblScope>
			<date type="published" when="2020-06-30" />
			<publisher>MDPI AG</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Model-Based Fault Detection and Identification for Switching Power Converters</title>
		<author>
			<persName><forename type="first">Jason</forename><surname>Poon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Palak</forename><surname>Jain</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ioannis</forename><forename type="middle">C</forename><surname>Konstantakopoulos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Costas</forename><surname>Spanos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Sanjib</forename><forename type="middle">Kumar</forename><surname>Panda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Seth</forename><forename type="middle">R</forename><surname>Sanders</surname></persName>
		</author>
		<idno type="DOI">10.1109/tpel.2016.2541342</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Power Electronics</title>
		<title level="j" type="abbrev">IEEE Trans. Power Electron.</title>
		<idno type="ISSN">0885-8993</idno>
		<idno type="ISSNe">1941-0107</idno>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="1419" to="1430" />
			<date type="published" when="2017-02" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">An Autonomous Home Energy Management System Using Dynamic Priority Strategy in Conventional Homes</title>
		<author>
			<persName><forename type="first">Mohammad</forename><surname>Shakeri</surname></persName>
			<idno type="ORCID">0000-0003-2456-4356</idno>
		</author>
		<author>
			<persName><forename type="first">Nowshad</forename><surname>Amin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jagadeesh</forename><surname>Pasupuleti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Abolfazl</forename><surname>Mehbodniya</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Nilofar</forename><surname>Asim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Sieh</forename><forename type="middle">Kiong</forename><surname>Tiong</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Foo</forename><forename type="middle">Wah</forename><surname>Low</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Chong</forename><forename type="middle">Tak</forename><surname>Yaw</surname></persName>
			<idno type="ORCID">0000-0002-5044-6110</idno>
		</author>
		<author>
			<persName><forename type="first">Nurul</forename><forename type="middle">Asma</forename><surname>Samsudin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Md</forename><surname>Rokonuzzaman</surname></persName>
			<idno type="ORCID">0000-0002-0534-4801</idno>
		</author>
		<author>
			<persName><forename type="first">Chong</forename><forename type="middle">Kok</forename><surname>Hen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Chin</forename><forename type="middle">Wei</forename><surname>Lai</surname></persName>
			<idno type="ORCID">0000-0002-7549-5015</idno>
		</author>
		<idno type="DOI">10.3390/en13133312</idno>
	</analytic>
	<monogr>
		<title level="j">Energies</title>
		<title level="j" type="abbrev">Energies</title>
		<idno type="ISSNe">1996-1073</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">13</biblScope>
			<biblScope unit="page">3312</biblScope>
			<date type="published" when="2020-06-28" />
			<publisher>MDPI AG</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Digital Twin in Industry: State-of-the-Art</title>
		<author>
			<persName><forename type="first">Fei</forename><surname>Tao</surname></persName>
			<idno type="ORCID">0000-0002-9020-0633</idno>
		</author>
		<author>
			<persName><forename type="first">He</forename><surname>Zhang</surname></persName>
			<idno type="ORCID">0000-0002-7630-2211</idno>
		</author>
		<author>
			<persName><forename type="first">Ang</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">Y C</forename><surname>Nee</surname></persName>
		</author>
		<idno type="DOI">10.1109/tii.2018.2873186</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Industrial Informatics</title>
		<title level="j" type="abbrev">IEEE Trans. Ind. Inf.</title>
		<idno type="ISSN">1551-3203</idno>
		<idno type="ISSNe">1941-0050</idno>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="2405" to="2415" />
			<date type="published" when="2019-04" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">IoT-Based Smart Plug for Residential Energy Conservation: An Empirical Study Based on 15 Months’ Monitoring</title>
		<author>
			<persName><forename type="first">Jooseok</forename><surname>Oh</surname></persName>
			<idno type="ORCID">0000-0001-8302-8268</idno>
		</author>
		<idno type="DOI">10.3390/en13154035</idno>
	</analytic>
	<monogr>
		<title level="j">Energies</title>
		<title level="j" type="abbrev">Energies</title>
		<idno type="ISSNe">1996-1073</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">15</biblScope>
			<biblScope unit="page">4035</biblScope>
			<date type="published" when="2020-08-04" />
			<publisher>MDPI AG</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">An Alertness-Adjustable Cloud/Fog IoT Solution for Timely Environmental Monitoring Based on Wildfire Risk Forecasting</title>
		<author>
			<persName><forename type="first">Athanasios</forename><surname>Tsipis</surname></persName>
			<idno type="ORCID">0000-0001-5069-3376</idno>
		</author>
		<author>
			<persName><forename type="first">Asterios</forename><surname>Papamichail</surname></persName>
			<idno type="ORCID">0000-0002-5729-4017</idno>
		</author>
		<author>
			<persName><forename type="first">Ioannis</forename><surname>Angelis</surname></persName>
			<idno type="ORCID">0000-0002-7161-7599</idno>
		</author>
		<author>
			<persName><forename type="first">George</forename><surname>Koufoudakis</surname></persName>
			<idno type="ORCID">0000-0003-4214-5729</idno>
		</author>
		<author>
			<persName><forename type="first">Georgios</forename><surname>Tsoumanis</surname></persName>
			<idno type="ORCID">0000-0001-9010-3422</idno>
		</author>
		<author>
			<persName><forename type="first">Konstantinos</forename><surname>Oikonomou</surname></persName>
			<idno type="ORCID">0000-0001-7279-9710</idno>
		</author>
		<idno type="DOI">10.3390/en13143693</idno>
	</analytic>
	<monogr>
		<title level="j">Energies</title>
		<title level="j" type="abbrev">Energies</title>
		<idno type="ISSNe">1996-1073</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">14</biblScope>
			<biblScope unit="page">3693</biblScope>
			<date type="published" when="2020-07-17" />
			<publisher>MDPI AG</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">HEMS-IoT: A Big Data and Machine Learning-Based Smart Home System for Energy Saving</title>
		<author>
			<persName><forename type="first">Isaac</forename><surname>Machorro-Cano</surname></persName>
			<idno type="ORCID">0000-0002-3822-4478</idno>
		</author>
		<author>
			<persName><forename type="first">Giner</forename><surname>Alor-Hernández</surname></persName>
			<idno type="ORCID">0000-0003-3296-0981</idno>
		</author>
		<author>
			<persName><forename type="first">Mario</forename><forename type="middle">Andrés</forename><surname>Paredes-Valverde</surname></persName>
			<idno type="ORCID">0000-0001-9508-9818</idno>
		</author>
		<author>
			<persName><forename type="first">Lisbeth</forename><surname>Rodríguez-Mazahua</surname></persName>
		</author>
		<author>
			<persName><forename type="first">José</forename><forename type="middle">Luis</forename><surname>Sánchez-Cervantes</surname></persName>
			<idno type="ORCID">0000-0001-5194-1263</idno>
		</author>
		<author>
			<persName><forename type="first">José</forename><forename type="middle">Oscar</forename><surname>Olmedo-Aguirre</surname></persName>
		</author>
		<idno type="DOI">10.3390/en13051097</idno>
	</analytic>
	<monogr>
		<title level="j">Energies</title>
		<title level="j" type="abbrev">Energies</title>
		<idno type="ISSNe">1996-1073</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page">1097</biblScope>
			<date type="published" when="2020-03-02" />
			<publisher>MDPI AG</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">Internet of things (IoT) and the energy sector</title>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">N</forename><surname>Motlagh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Mohammadrezaei</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Hunt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Zakeri</surname></persName>
		</author>
		<imprint>
			<biblScope unit="volume">2020</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Energy Management-as-a-Service Over Fog Computing Platform</title>
		<author>
			<persName><forename type="first">Mohammad</forename><forename type="middle">Abdullah</forename><surname>Al Faruque</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Korosh</forename><surname>Vatanparvar</surname></persName>
		</author>
		<idno type="DOI">10.1109/jiot.2015.2471260</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Internet of Things Journal</title>
		<title level="j" type="abbrev">IEEE Internet Things J.</title>
		<idno type="ISSNe">2327-4662</idno>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="161" to="169" />
			<date type="published" when="2016-04" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Economic Management Based on Hybrid MPC for Microgrids: A Brazilian Energy Market Solution</title>
		<author>
			<persName><forename type="first">Eduardo</forename><surname>Conte</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Paulo</forename><forename type="middle">R C</forename><surname>Mendes</surname></persName>
			<idno type="ORCID">0000-0003-3589-369X</idno>
		</author>
		<author>
			<persName><forename type="first">Julio</forename><forename type="middle">E</forename><surname>Normey-Rico</surname></persName>
			<idno type="ORCID">0000-0002-6510-9803</idno>
		</author>
		<idno type="DOI">10.3390/en13133508</idno>
	</analytic>
	<monogr>
		<title level="j">Energies</title>
		<title level="j" type="abbrev">Energies</title>
		<idno type="ISSNe">1996-1073</idno>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">13</biblScope>
			<biblScope unit="page">3508</biblScope>
			<date type="published" when="2020-07-07" />
			<publisher>MDPI AG</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Model-Based Design of Complex Aeronautical Systems Through Digital Twin and Thread Concepts</title>
		<author>
			<persName><forename type="first">Gray</forename><surname>Bachelor</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Eugenio</forename><surname>Brusa</surname></persName>
			<idno type="ORCID">0000-0001-7478-0650</idno>
		</author>
		<author>
			<persName><forename type="first">Davide</forename><surname>Ferretto</surname></persName>
			<idno type="ORCID">0000-0003-2294-9105</idno>
		</author>
		<author>
			<persName><forename type="first">Andreas</forename><surname>Mitschke</surname></persName>
		</author>
		<idno type="DOI">10.1109/jsyst.2019.2925627</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Systems Journal</title>
		<title level="j" type="abbrev">IEEE Systems Journal</title>
		<idno type="ISSN">1932-8184</idno>
		<idno type="ISSNe">2373-7816</idno>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="1568" to="1579" />
			<date type="published" when="2020-06" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
		<title/>
		<author>
			<persName><surname>Aws Iot-Developer Guide</surname></persName>
		</author>
		<ptr target="https://docs.aws.amazon.com/iot/latest/developerguide/iot-dg.pdf" />
		<imprint>
			<date type="published" when="2019-12" />
			<biblScope unit="page">17</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title/>
		<author>
			<persName><surname>Digital Twin|ge Digital</surname></persName>
		</author>
		<ptr target="https://www.ge.com/digital/applications/digital-twin" />
		<imprint>
			<date type="published" when="2019-12" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Keiper speeds up product development with Tecnomatix, Siemens PLM Softwares digital manufacturing technology</title>
		<idno type="DOI">10.1108/aa.2009.03329bab.004</idno>
		<ptr target="https://www.plm.automation.siemens.com/global/en/our-story/glossary/digital-twin/24465" />
	</analytic>
	<monogr>
		<title level="j">Assembly Automation</title>
		<title level="j" type="abbrev">Assembly Automation</title>
		<idno type="ISSN">0144-5154</idno>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">2</biblScope>
			<date type="published" when="2009-04-17" />
			<publisher>Emerald</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Reference Framework for Digital Twins within Cyber-Physical Systems</title>
		<author>
			<persName><forename type="first">Klementina</forename><surname>Josifovska</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Enes</forename><surname>Yigitbas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gregor</forename><surname>Engels</surname></persName>
		</author>
		<idno type="DOI">10.1109/sescps.2019.00012</idno>
	</analytic>
	<monogr>
		<title level="m">2019 IEEE/ACM 5th International Workshop on Software Engineering for Smart Cyber-Physical Systems (SEsCPS)</title>
				<meeting><address><addrLine>Montreal, QC, Canada</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2019-05" />
			<biblScope unit="page" from="25" to="31" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">A Digital Twin Based Industrial Automation and Control System Security Architecture</title>
		<author>
			<persName><forename type="first">Christian</forename><surname>Gehrmann</surname></persName>
			<idno type="ORCID">0000-0001-8003-200X</idno>
		</author>
		<author>
			<persName><forename type="first">Martin</forename><surname>Gunnarsson</surname></persName>
		</author>
		<idno type="DOI">10.1109/tii.2019.2938885</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Industrial Informatics</title>
		<title level="j" type="abbrev">IEEE Trans. Ind. Inf.</title>
		<idno type="ISSN">1551-3203</idno>
		<idno type="ISSNe">1941-0050</idno>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="669" to="680" />
			<date type="published" when="2020-01" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">C2PS: A Digital Twin Architecture Reference Model for the Cloud-Based Cyber-Physical Systems</title>
		<author>
			<persName><forename type="first">Kazi</forename><forename type="middle">Masudul</forename><surname>Alam</surname></persName>
			<idno type="ORCID">0000-0003-4731-9847</idno>
		</author>
		<author>
			<persName><forename type="first">Abdulmotaleb</forename><surname>El Saddik</surname></persName>
			<idno type="ORCID">0000-0002-7690-8547</idno>
		</author>
		<idno type="DOI">10.1109/access.2017.2657006</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Access</title>
		<title level="j" type="abbrev">IEEE Access</title>
		<idno type="ISSNe">2169-3536</idno>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="2050" to="2062" />
			<date type="published" when="2017" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Design and Implementation of Smart Micro-Grid and Its Digital Replica: First Steps</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">José</forename><surname>Calderón Godoy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Isaías</forename><surname>Pérez</surname></persName>
		</author>
		<idno type="DOI">10.5220/0007923707150721</idno>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 16th International Conference on Informatics in Control, Automation and Robotics</title>
				<meeting>the 16th International Conference on Informatics in Control, Automation and Robotics<address><addrLine>Prague, Czech Republic</addrLine></address></meeting>
		<imprint>
			<publisher>SCITEPRESS - Science and Technology Publications</publisher>
			<date type="published" when="2019" />
			<biblScope unit="page" from="715" to="721" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Data-Centric Hierarchical Distributed Model Predictive Control for Smart Grid Energy Management</title>
		<author>
			<persName><forename type="first">Ahmed</forename><surname>Saad</surname></persName>
			<idno type="ORCID">0000-0001-9726-7411</idno>
		</author>
		<author>
			<persName><forename type="first">Tarek</forename><surname>Youssef</surname></persName>
			<idno type="ORCID">0000-0001-9047-9163</idno>
		</author>
		<author>
			<persName><forename type="first">Ahmed</forename><forename type="middle">T</forename><surname>Elsayed</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Amr</forename><surname>Amin</surname></persName>
			<idno type="ORCID">0000-0002-6761-3050</idno>
		</author>
		<author>
			<persName><forename type="first">Omar</forename><forename type="middle">Hanafy</forename><surname>Abdalla</surname></persName>
			<idno type="ORCID">0000-0002-8847-0829</idno>
		</author>
		<author>
			<persName><forename type="first">Osama</forename><surname>Mohammed</surname></persName>
			<idno type="ORCID">0000-0002-2586-4046</idno>
		</author>
		<idno type="DOI">10.1109/tii.2018.2883911</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Industrial Informatics</title>
		<title level="j" type="abbrev">IEEE Trans. Ind. Inf.</title>
		<idno type="ISSN">1551-3203</idno>
		<idno type="ISSNe">1941-0050</idno>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="4086" to="4098" />
			<date type="published" when="2019-07" />
			<publisher>Institute of Electrical and Electronics Engineers (IEEE)</publisher>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
